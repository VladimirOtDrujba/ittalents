ACC.autocomplete={bindAll:function(){this.bindSearchAutocomplete(),this.bindAutocompleteHandlers()},bindAutocompleteHandlers:function(){var a,b;a=$("#search"),b=$("#search_autocomplete"),a.keydown(function(a){9==a.which||39==a.which?$(this).val($(b).val()):(8==a.which||46==a.which||32==a.which)&&$(b).val("")})},bindSearchAutocomplete:function(){if($("#search").length){eval("var option="+($search=$("#search")).data("options"));var cache={};$("#search").autocomplete({minLength:option.minCharactersBeforeRequest,delay:option.waitTimeBeforeRequest,appendTo:"#ajax_search_results",source:function(b,c){$(".search-products, .search-categories, .search-previous").html(""),$(".category--previous").addClass("el-hide");var a=b.term.toLowerCase();if(a in cache)return $.each(cache[a],function(b,a){"autoSuggestion"==a.type&&$("#search_autocomplete").val(a.value)}),c(cache[a]);$.getJSON(option.autocompleteUrl,{term:b.term},function(b){var d=[];if(null!=b.suggestions&&b.suggestions.length>0){var e=b.suggestions[0].term;" "!==a.slice(-1)&&($("#search_autocomplete").val(e),d.push({value:e,url:ACC.config.contextPath+"/search?query="+e,type:"autoSuggestion"}))}else $("#search_autocomplete").val(""),d.push({value:"",url:ACC.config.contextPath+"/search?query="+e,type:"autoSuggestion"});return null!=b.products&&$.each(b.products,function(b,a){d.push({value:a.name,code:a.code,desc:a.description,manufacturer:a.manufacturer,url:ACC.config.contextPath+a.url,price:a.price?a.price.formattedValue:"",type:"productResult",image:a.images&&a.images[0]?a.images[0].url:""})}),null!=b.categoryFacets&&$.each(b.categoryFacets,function(b,a){d.push({value:a.name,code:a.code,url:a.query.url,count:a.count,type:"categoryFacet"})}),null!=b.topSearches&&$.each(b.topSearches,function(b,a){d.push({value:a.facetName,type:"topSearchesFacet"})}),cache[a]=d,d.length>0&&$(".ajax_search_results").addClass("el-show"),c(d)})},select:function(b,a){window.location.href=a.item.url}}).data("autocomplete")._renderItem=function(c,a){if($(".ajax_search_results").addClass("el-show"),"autoSuggestion"==a.type){var b="";return $("<li>").data("item.autocomplete",a)}if("productResult"==a.type){var b="";return option.displayProductImages&&null!=a.image&&""!=a.image?(b+="<figure> <div class='preview'> <img src='"+a.image+"' alt='"+a.value+"'/> </div>",b+="<figcaption><p> <a href='"+ACC.config.contextPath+a.url+"'>"+a.value+"</a></p></figcaption>",b+="</figure>"):(b+="<figure>",b+="<figcaption><p> <a href='"+ACC.config.contextPath+a.url+"'>"+a.value+"</a></p></figcaption>",b+="</figure>"),$("<li>").data("item.autocomplete",a).append(b).appendTo($(".search-products"))}if("categoryFacet"==a.type){var b="";return b+="<a href='"+ACC.config.contextPath+a.url+"'>",b+=a.value+" ("+a.count+")",b+="</a>",$("<li>").data("item.autocomplete",a).append(b).appendTo($(".search-categories"))}if("topSearchesFacet"==a.type){$(".category--previous").removeClass("el-hide");var b="";return b+="<a href='"+ACC.config.contextPath+"/search/ALL/?query="+a.value+"&query_autocomplete=&search_main_category=ALL'>",b+=a.value,b+="</a>",$("<li>").data("item.autocomplete",a).append(b).appendTo($(".search-previous"))}}}}},$(document).ready(function(){ACC.autocomplete.bindAll(),$(document.body).on("click",function(a){0==$(a.target).closest($(".search-form")).length&&$(".ajax_search_results").removeClass("el-show")})})